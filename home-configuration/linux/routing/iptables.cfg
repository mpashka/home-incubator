# Generated by iptables-save v1.8.4 on Tue Jun  8 16:00:26 2021
*mangle
:PREROUTING ACCEPT [26846:13648071]
:INPUT ACCEPT [25725:13469951]
:FORWARD ACCEPT [1119:177996]
:OUTPUT ACCEPT [26335:7762608]
:POSTROUTING ACCEPT [26644:7781059]
-A POSTROUTING -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android mangle postrouting: "
COMMIT
# Completed on Tue Jun  8 16:00:26 2021
# Generated by iptables-save v1.8.4 on Tue Jun  8 16:00:26 2021
*nat
:PREROUTING ACCEPT [1596:295441]
:INPUT ACCEPT [657:119341]
:OUTPUT ACCEPT [2332:211863]
:POSTROUTING ACCEPT [2437:218163]
:ANDROID - [0:0]
:DOCKER - [0:0]
-A PREROUTING -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android nat prerouting: "
-A PREROUTING -d 10.254.0.0/16 -i enp1s0 -p tcp -j REDIRECT --to-ports 9040
-A PREROUTING -m addrtype --dst-type LOCAL -j DOCKER
-A OUTPUT -d 10.254.0.0/16 -p tcp -j REDIRECT --to-ports 9040
-A OUTPUT ! -d 127.0.0.0/8 -m addrtype --dst-type LOCAL -j DOCKER
-A POSTROUTING -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android nat postrouting: "
-A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUERADE
-A POSTROUTING -s 172.17.0.2/32 -d 172.17.0.2/32 -p tcp -m tcp --dport 1883 -j MASQUERADE
-A POSTROUTING -s 192.168.2.0/24 ! -d 192.168.2.0/24 -m addrtype --dst-type UNICAST -m addrtype --src-type UNICAST -j ANDROID
-A ANDROID -d 10.254.0.0/16 -j RETURN
-A ANDROID -d 192.168.3.0/24 -j RETURN
-A ANDROID -j LOG --log-prefix "android routing: "
-A ANDROID -j SNAT --to-source 192.168.2.4
-A DOCKER -i docker0 -j RETURN
-A DOCKER ! -i docker0 -p tcp -m tcp --dport 1883 -j DNAT --to-destination 172.17.0.2:1883
COMMIT
# Completed on Tue Jun  8 16:00:26 2021
# Generated by iptables-save v1.8.4 on Tue Jun  8 16:00:26 2021
*filter
:INPUT ACCEPT [1564:788394]
:FORWARD DROP [51:9714]
:OUTPUT ACCEPT [1635:608696]
:DOCKER - [0:0]
:DOCKER-ISOLATION-STAGE-1 - [0:0]
:DOCKER-ISOLATION-STAGE-2 - [0:0]
:DOCKER-USER - [0:0]
-A FORWARD -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android filter forward: "
-A FORWARD -j DOCKER-USER
-A FORWARD -j DOCKER-ISOLATION-STAGE-1
-A FORWARD -o docker0 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
-A FORWARD -o docker0 -j DOCKER
-A FORWARD -i docker0 ! -o docker0 -j ACCEPT
-A FORWARD -i docker0 -o docker0 -j ACCEPT
-A FORWARD -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android filter forward2: "
-A DOCKER -d 172.17.0.2/32 ! -i docker0 -o docker0 -p tcp -m tcp --dport 1883 -j ACCEPT
-A DOCKER-ISOLATION-STAGE-1 -i docker0 ! -o docker0 -j DOCKER-ISOLATION-STAGE-2
-A DOCKER-ISOLATION-STAGE-1 -j RETURN
-A DOCKER-ISOLATION-STAGE-2 -o docker0 -j DROP
-A DOCKER-ISOLATION-STAGE-2 -j RETURN
-A DOCKER-USER -j RETURN
COMMIT
# Completed on Tue Jun  8 16:00:26 2021
