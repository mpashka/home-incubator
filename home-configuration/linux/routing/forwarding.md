iptables -t nat -A POSTROUTING --source 192.168.2.0/24 ! --destination 192.168.2.0/24 -m addrtype --dst-type UNICAST -m addrtype --src-type UNICAST -j ANDROID
iptables -t nat -N ANDROID
iptables -t nat -A ANDROID --destination 10.254.0.0/16 -j RETURN
iptables -t nat -A ANDROID --destination 192.168.3.0/24 -j RETURN

---
*mangle
:POSTROUTING ACCEPT [77542:16987277]
:MY_ROUTE - [0:0]
-A PREROUTING -s 192.168.2.0/24 ! -d 192.168.2.0/24 -m addrtype --dst-type UNICAST -j MY_ROUTE
-A MY_ROUTE -d 192.168.2.0/24 -j ACCEPT
-A MY_ROUTE -d 10.254.0.0/16 -j ACCEPT
-A MY_ROUTE -j LOG --log-prefix passthr
-A MY_ROUTE -j MARK --set-xmark 0x231/0xffffffff

echo 100 table_android >> /etc/iproute2/rt_tables
ip rule add fwmark 0x231 table_android
ip route add default via 195.96.98.253 dev ppp0 table mail.out

---
ifconfig enp1s0 192.168.2.4/25
ifconfig enp1s0:0 192.168.2.129/25
-> ifconfig enp1s0 192.168.2.4/24; ifconfig enp1s0:0 down
dnsmasq:
router,192.168.2.129

---
https://www.opennet.ru/base/sys/sysctl_linux.txt.html

net.ipv4.conf.all.send_redirects=0
Включает/выключает выдачу ICMP Redirect  другим хостам. Эта опция
обязательно должна быть включена, если хост выступает в роли
маршрутизатора любого рода. Как правило ICMP-сообщения о переадресации
отправляются в том случае, когда необходимо сообщить хосту о том, что он
должен вступить в контакт с другим сервером. Переменная может иметь два
значения  0 (выключено) и 1 (включено). Значение по-умолчанию  1
(включено). Если компьютер не выступает в роли маршрутизатора, то эту
переменную можно отключить.


net.ipv4.conf.all.rp_filter
Включает/выключает reverse path filter (проверка обратного адреса  хотя
это слишком вольный перевод термина, но мне он кажется наиболее близким
по смыслу. прим. перев.) для заданного интерфейса. Смысл этой переменной
достаточно прост  все что поступает к нам проходит проверку на
соответствие исходящего адреса с нашей таблицей маршрутизации и такая
проверка считается успешной, если принятый пакет предполагает передачу
ответа через тот же самый интерфейс. Если вы используете расширенную
маршрутизацию тем или иным образом, то вам следует всерьез задуматься о
выключении этой переменной, поскольку она может послужить причиной
потери пакетов. Например, в случае, когда входящий трафик идет через
один маршрутизатор, а исходящий  через другой. Так, WEB-сервер,
подключенный через один сетевой интерфейс к входному роутеру, а через
другой  к выходному (в случае, когда включен rp_filter), будет просто
терять входящий трафик, поскольку обратный маршрут, в таблице
маршрутизации, задан через другой интерфейс. Переменная может иметь два
значения  0 (выключено) и 1 (включено). Значение по-умолчанию  0
(выключено). Однако в некоторых дистрибутивах по-умолчанию эта
переменная включается в стартовых скриптах на этапе загрузки. Поэтому,
если у вас эта переменная включена, а вам надо ее выключить  просмотрите
стартовые скрипты в каталоге rc.d. Более детальную информацию об этой
переменной вы найдете в RFC 1812 - Requirements for IP Version 4 Routers
на страницах 46-49 (секция 4.2.2.11), странице 55 (секция 4.3.2.7) и
странице 90 (секция 5.3.3.3). Если вы всерьез занимаетесь проблемами
маршрутизации, то вам определенно придется изучить этот документ.


net.ipv4.conf.all.proxy_arp = 0
Включает/выключает проксирование arp-запросов для заданного интерфейса.
ARP-прокси позволяет маршрутизатору отвечать на ARP запросы в одну сеть,
в то время как запрашиваемый хост находится в другой сети. С помощью
этого средства происходит обман отправителя, который отправил ARP
запрос, после чего он думает, что маршрутизатор является хостом
назначения, тогда как в действительности хост назначения находится на
другой стороне маршрутизатора. Маршрутизатор выступает в роли
уполномоченного агента хоста назначения, перекладывая пакеты от другого
хоста. Переменная может иметь два значения  0 (выключено) и 1
(включено). Значение по-умолчанию  0 (выключено). Дополнительную
информацию вы найдете в Proxy-ARP mini HOWTO.


--- debug
iptables -t nat -I PREROUTING 1 -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android nat prerouting: "
iptables -t filter -I FORWARD 1 -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android filter forward: "
iptables -t nat -I POSTROUTING 1 -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android nat postrouting: " <- хер
iptables -t mangle -I POSTROUTING 1 -s 192.168.2.50/32 ! -d 192.168.2.0/24 -j LOG --log-prefix "android mangle postrouting: "

[Tue Jun  8 15:24:02 2021] android nat prerouting: IN=enp1s0 OUT= MAC=18:c0:4d:ba:79:e7:f0:81:73:a2:81:ff:08:00 SRC=192.168.2.50 DST=149.154.167.51 LEN=60 TOS=0x00 PREC=0x00 TTL=64 ID=54389 DF PROTO=TCP SPT=51405 DPT=443 WINDOW=65535 RES=0x00 SYN URGP=0
[Tue Jun  8 15:24:02 2021] android filter forward: IN=enp1s0 OUT=enp1s0 MAC=18:c0:4d:ba:79:e7:f0:81:73:a2:81:ff:08:00 SRC=192.168.2.50 DST=149.154.167.51 LEN=60 TOS=0x00 PREC=0x00 TTL=63 ID=54389 DF PROTO=TCP SPT=51405 DPT=443 WINDOW=65535 RES=0x00 SYN URGP=0 


Советы
net.ipv4.conf.all.send_redirects=0 и net.ipv4.conf.$IFNAME.send_redirects=0
arp роутинг
Пробей через ip rule на сервере
